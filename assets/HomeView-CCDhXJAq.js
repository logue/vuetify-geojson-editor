import{u as N}from"./index-DXFcP6LQ.js";import{X as Ue,b as g,f as U,h as J,a8 as He,s as $e,B as Be,W as et,a1 as tt,$ as B,_ as j,J as ot,a0 as t,n as e,V as c,O as ee,a9 as at,aa as ce,a3 as ve,v as E,w as te,u as D,H as Y,K as lt,ab as nt}from"./vue-C9g6RwH9.js";import{G as he,S as $,T as re,C as it,a as W,F as Q,I as Re,b as rt,P as Ve,V as st,t as ut,c as dt,d as ue,e as we,o as ct,M as pt,Z as mt,f as ft,g as vt,A as yt,h as Fe,i as gt,j as St,k as wt,O as At,l as xt,m as Ct,n as je,s as kt,p as bt,q as ht,r as ye,u as Vt,D as ge,v as Oe,w as Ft,x as Ot,y as It,z as Et,B as Tt,E as Pt}from"./openlayers-N34ocCXD.js";import{t as Ie,v as xe,a as Ge,b as Mt,c as _t,d as M,e as Z,f as Lt,r as Ut,g as Bt}from"./misc-0P--jxPj.js";import{t as Rt,v as jt,a as Gt,w as Dt,x as K,c as de,b as G,y as ae,z as le,A as ne,V as C,j as H,B as T,u as De,C as Ce,D as Nt,E as Ee,F as Jt,G as Te,H as Wt,I as X,J as z,K as qt,L as Qt,M as Xt,N as Pe,O as zt,P as Ne,Q as Yt,R as Kt,S as Zt,T as Ht}from"./vuetify-C-oxdWip.js";import{m as $t,j as eo,a as to}from"./codemirror-lang-DLhXx0-9.js";import{K as Je}from"./codemirror-CCM5w5QQ.js";const oe={id:void 0,name:void 0,description:void 0,annotation:void 0,annotationStyle:void 0,icon:void 0,color:"light-blue",opacity:void 0,thickness:void 0,level:0},pe=Ue("geojson-editor",()=>{const i=g({type:"FeatureCollection",features:[]}),l=U(()=>Ie({data:i.value})),f=g(!0);function a(A){let k=0;A.forEach(y=>{k++,y.getId()||y.setId(xe());let v=y.getProperties();v||(v=oe,v.no=k),y.setProperties(v)}),new he().writeFeatures(A,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})}function o(){return new he().readFeatures(i.value,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})}function p(A="geojson",k=!1,y=!1){i.value.type==="FeatureCollection"&&i.value.features.forEach(h=>(delete h.id,h));let v=Ge(i.value);y&&(v=Mt(v));const I=JSON.stringify(A==="topojson"?{$schema:"https://raw.githubusercontent.com/Casyfill/TopoJSON_schema/master/topology.json",...Ie({data:v})}:{$schema:"https://json.schemastore.org/geojson.json",...v},null,k?2:0);return new Blob([I],{type:"application/geo+json"})}function s(A){i.value=A}function S(){i.value={type:"FeatureCollection",features:[]},f.value=!0}function w(A=!0){f.value=A}return{geojson:i,topojson:l,requestRefresh:f,exportBlob:p,setGeoJson:s,setFeatures:a,getFeatures:o,clear:S,setRefresh:w}},{persist:{storage:window.localStorage}}),ke=Ue("map-cursor",()=>{const i=g([0,0]),l=g(1),f=g(0);function a(s){i.value=s}function o(s){l.value=s}function p(s){f.value=s}return{level:f,zoom:l,coordinate:i,setCoordinate:a,setZoom:o,setLevel:p}});class oo{colorSet;fontFace;pointSize;pointFillColor;pointFillOpacity;pointStrokeColor;pointStrokeOpacity;pointStrokeWidth;fillColor;fillOpacity;strokeColor;strokeOpacity;strokeWidth;textColor;textStyle;textOpacity;textStrokeColor;textStrokeOpacity;textStrokeWidth;iconOpacity;iconTextStyle;gridColor;gridOpacity;gridTextStyle;constructor(l="light-blue",f="'Roboto', 'Noto Sans JP','Noto Color Emoji', sans-serif"){this.colorSet=Rt[_t(l)],this.fontFace=f}getStyle(){return new $({fill:new Q({color:M(this.fillColor).alpha(this.fillOpacity).css()}),stroke:new W({color:M(this.strokeColor).alpha(this.strokeOpacity).css(),width:this.strokeWidth}),image:new it({radius:this.pointSize,stroke:new W({color:M(this.pointStrokeColor).alpha(this.pointStrokeOpacity).css(),width:this.pointStrokeWidth}),fill:new Q({color:M(this.pointFillColor).alpha(this.pointFillOpacity).css()})}),text:new re({font:this.textStyle,fill:new Q({color:M(this.textColor).alpha(this.textOpacity).css()}),stroke:new W({color:M(this.textStrokeColor).alpha(this.textStrokeOpacity).css(),width:this.textStrokeWidth}),overflow:!0,text:""})})}getIconStyle(l){return new $({image:new Re({anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction",src:`./img/markers/${l}.png`,scale:.75,opacity:this.iconOpacity}),text:new re({offsetX:0,offsetY:10,font:this.textStyle,fill:new Q({color:M(this.textColor).alpha(this.textOpacity).css()}),stroke:new W({color:M(this.textStrokeColor).alpha(this.textStrokeOpacity).css(),width:this.textStrokeWidth}),overflow:!0,text:""})})}getLabelStyle(l){return new $({text:new re({font:this.textStyle,fill:new Q({color:M(this.textColor).alpha(this.textOpacity).css()}),stroke:new W({color:M(this.textStrokeColor).alpha(this.textStrokeOpacity).css(),width:this.textStrokeWidth}),overflow:!0,offsetY:l,text:""})})}getGridStyle(){return new $({stroke:new W({color:M(this.gridColor).alpha(this.gridOpacity).css()}),text:new re({font:this.gridTextStyle,fill:new Q({color:M(this.colorSet.accent2).css()}),stroke:new W({color:M(this.colorSet.lighten1).alpha(this.textStrokeOpacity).css(),width:1})})})}}class q extends oo{pointFillColor=this.colorSet.accent1||this.colorSet.lighten4;pointFillOpacity=.35;pointStrokeColor=this.colorSet.accent3||this.colorSet.lighten3;pointStrokeOpacity=1;pointStrokeWidth=1;pointSize=5;pointTextStyle=`400 0.3rem ${this.fontFace}`;fillColor=this.colorSet.accent1||this.colorSet.lighten4;fillOpacity=.25;strokeColor=this.colorSet.accent3||this.colorSet.lighten3;strokeOpacity=.75;strokeWidth=1;textColor=this.colorSet.darken4;textStyle=`600 1rem ${this.fontFace}`;textOpacity=1;textStrokeColor=this.colorSet.lighten5;textStrokeOpacity=.5;textStrokeWidth=2.5;iconOpacity=1;iconTextStyle=`500 0.75rem ${this.fontFace}`;gridColor=this.colorSet.base;gridOpacity=.5;gridTextStyle=`900 1.5rem ${this.fontFace}`}class ie extends q{fillOpacity=0;textStrokeOpacity=.75;textStyle=`600 1.5rem ${this.fontFace}`}class ao extends ie{pointFillColor=this.colorSet.accent4||this.colorSet.base;pointFillOpacity=1;pointStrokeColor=this.colorSet.accent2||this.colorSet.lighten4;pointStrokeOpacity=1;pointStrokeWidth=2;fillColor=this.colorSet.accent1||this.colorSet.lighten5;fillOpacity=.25;strokeWidth=3;textStrokeColor=this.colorSet.lighten5;textStrokeOpacity=1}const P={ACTIVE:"active",INACTIVE:"inactive",HOVER:"hover",SELECTED:"selected"};class Se extends q{}class lo extends q{pointFillOpacity=.5;pointStrokeOpacity=1;fillOpacity=.5;textOpacity=1;strokeOpacity=1;textStrokeOpacity=1}class Me extends q{pointFillOpacity=.05;pointStrokeOpacity=.25;fillOpacity=.05;strokeOpacity=.25;iconOpacity=.5;textOpacity=.5;textStrokeOpacity=.25}class no extends ie{}class io extends ie{textStrokeOpacity=1;textOpacity=1;fillOpacity=.1}class ro extends ie{fillOpacity=0;strokeOpacity=.25;textOpacity=.5;textStrokeOpacity=.25}class _e extends q{pointFillColor=this.colorSet.accent4||this.colorSet.base;pointFillOpacity=1;pointStrokeColor=this.colorSet.accent2||this.colorSet.lighten4;pointStrokeOpacity=1;pointStrokeWidth=2;fillColor=this.colorSet.accent1||this.colorSet.lighten5;fillOpacity=.5;strokeWidth=3;textStrokeColor=this.colorSet.lighten5;textStrokeOpacity=1}class se{static fontFace="'Roboto', 'Noto Sans JP','Noto Color Emoji', sans-serif";static getStyle(l,f=P.ACTIVE){let a;switch(f){case P.INACTIVE:a=new Me(l,this.fontFace);break;case P.SELECTED:a=new _e(l,this.fontFace);break;case P.HOVER:a=new lo(l,this.fontFace);break;case P.ACTIVE:a=new Se(l,this.fontFace);break;default:a=new q(l,this.fontFace)}return a.getStyle(l)}static getSectionPolygonStyle(l,f=P.ACTIVE){let a;switch(f){case P.INACTIVE:a=new ro(l,this.fontFace);break;case P.SELECTED:a=new ao(l,this.fontFace);break;case P.HOVER:a=new io(l,this.fontFace);break;case P.ACTIVE:a=new no(l,this.fontFace);break;default:a=new ie(l,this.fontFace)}return a.getStyle(l)}static getIconStyle(l="pin",f="blue-grey",a=P.ACTIVE){let o;switch(a){case P.INACTIVE:o=new Me(f,this.fontFace);break;case P.SELECTED:o=new _e(f,this.fontFace);break;case P.ACTIVE:o=new Se(f,this.fontFace);break;default:o=new Se(f,this.fontFace)}return o.getIconStyle(l)}static getGridStyle(l="light-blue"){return new q(l,this.fontFace).getGridStyle()}}Z.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";Z.defaults.withCredentials=!0;Z.defaults.onUploadProgress=i=>{const l=N();i.progress&&i.total?l.setProgress(Math.round(i.loaded*100/i.total)):l.setProgress(null)};Z.defaults.onDownloadProgress=i=>{const l=N();i.progress&&i.total?l.setProgress(Math.round(i.loaded*100/i.total)):l.setProgress(null)};Z.interceptors.request.use(i=>(N().setLoading(!0),i));Z.interceptors.response.use(i=>(N().setLoading(!1),i),i=>{const l=N();if(l.setLoading(!1),i.response.status>=400)throw l.setMessage("不明なエラーが発生しました。"),new Error(i);return i.response});const so=new $({image:new Re({anchor:[.5,86],anchorXUnits:"fraction",anchorYUnits:"pixels",src:"./img/spotlight-poi2_hdpi.png",crossOrigin:"anonymous",opacity:1,size:[54,86],scale:.5})});function Le(i,l=0,f=0,a=void 0){i&&i.setStyle((o,p)=>{const s=o.getProperties(),S=o.getGeometry(),A=(s.level??0)===l?P.ACTIVE:P.INACTIVE,k=Ae(o,a??A,i.getProperties().id);return S?.getType()==="Point"&&s.icon&&f!==0&&k.getImage()?.setScale(f/p),k})}function Ae(i,l=P.ACTIVE,f){const a=i.getProperties();let o;if(a.icon?(o=se.getIconStyle(a.icon,a.color,l),o.getText()?.setText(a.annotation?.toString())):(a.annotation||(a.annotation=7,a.annotationStyle="500 0.5rem"),f==="sectionLayer"&&i.getGeometry()?.getType()==="Polygon"?o=se.getSectionPolygonStyle(a.color,l):o=se.getStyle(a.color,l)),l!==P.SELECTED){a.thickness&&o.getStroke()?.setWidth(a.thickness);const p=o.getFill();if(a.opacity&&p){const s=a.opacity,S=M(p.getColor());let w=l===P.ACTIVE?s:s/2;l===P.HOVER&&(w=.25),o.getFill()?.setColor(M(S).alpha(w).css())}}return a.annotation&&!a.icon&&(i.getGeometry()?.getType()==="Point"&&typeof a.annotation!="number"&&o.getImage()?.setOpacity(0),o.getText()?.setText(a.annotation.toString()),a.annotationStyle&&o.getText()?.setFont(`${a.annotationStyle} ${se.fontFace}`)),o}const uo=J({__name:"MapComponent",props:{zoom:{type:Number,default:6},minZoom:{type:Number,default:0},maxZoom:{type:Number,default:18},extentLimit:{type:Array,default:()=>{}},center:{type:Array,default:()=>[139.766667,35.681111]},contextMenu:{type:Boolean,default:!0},loadingMessage:{type:String,default:"Now Loading..."}},emits:["ready","contextmenu"],setup(i,{expose:l,emit:f}){const a=i,o=f,p=He(),s=ke(),S=g(),w=U({get:()=>s.zoom,set:b=>s.setZoom(b)}),A=U({get:()=>s.coordinate,set:b=>s.setCoordinate(b)}),k=p?.query;k.x&&k.y?A.value=[parseFloat(k.y),parseFloat(k.x)]:a.center&&(A.value=a.center),w.value=k.zoom?parseInt(k.zoom):a.zoom;const y=new rt({geometry:new Ve(A.value),name:"cursor"}),v=new st({center:ut(A.value,"EPSG:4326","EPSG:3857"),projection:"EPSG:3857",zoom:w.value,minZoom:a.minZoom,maxZoom:a.maxZoom,extent:a.extentLimit}),I=new dt;I.setProjection(v.getProjection()),I.setTracking(!0),I.on("change:position",()=>{const b=I.getPosition();y.setGeometry(b?new Ve(b):void 0)});const h=new ue({zIndex:999,style:so,visible:!0,source:new we({features:[y]}),properties:{id:"cursorLayer"}}),n=new ct,d=$e(new pt({controls:[new mt,new ft({coordinateFormat:xt(4),projection:"EPSG:4326"}),new vt,new yt({collapsible:!1}),new Fe({label:a.loadingMessage}),new gt({}),new St,n],view:v,layers:Lt([new wt({zIndex:0,properties:{id:"osm"},source:new At,visible:!0}),h])}));d.value.getInteractions().getArray().filter(b=>b instanceof Ct)[0].setActive(!1);const x=new je({condition:kt,layers:[h]});x.on("select",()=>{}),d.value.addInteraction(x),p?.query.x&&p?.query.y&&h.setVisible(!0),d.value.on("moveend",()=>{const b=d.value.getView(),_=b.getCenter()??a.center;A.value=[_[0],_[1]],w.value=b.getZoom()??0});const O=new Fe({label:a.loadingMessage,layers:d.value.getAllLayers()});return d.value.addControl(O),Be(()=>{S.value&&(d.value.setTarget(S.value),o("ready",S.value)),d.value.getViewport().addEventListener("contextmenu",b=>{b.preventDefault(),o("contextmenu",b)})}),et(()=>d.value.setTarget()),l({map:d,notification:n}),(b,_)=>(B(),tt("div",{ref_key:"ol",ref:S,class:"map-component py-0 px-0"},null,512))}});var We=Ut();const co=J({__name:"MapContextMenu",props:{map:{type:Object,default:void 0}},setup(i,{expose:l}){const f=i,a=at(),o=N(),p=ke(),s=g(!1),S=g({x:0,y:0}),w=g([0,0]),A=U(()=>p.zoom),k=async()=>{const h=a.resolve({query:{x:w.value[1].toFixed(6).toString(),y:w.value[0].toFixed(6).toString(),zoom:Math.round(A.value).toString()}});await navigator.clipboard.writeText(location.origin+h.href),o.setMessage("Copied to clipboard this coordinate link url.")},y=async(h=!1)=>{if(!f.map)return;const n=f.map;o.setLoading(!0),n.once("rendercomplete",()=>{const d=n.getSize()??[0,0],V=document.createElement("canvas");V.width=d[0],V.height=d[1];const F=V.getContext("2d");F.fillStyle="#1d3b58",F.fillRect(0,0,V.width,V.height);let x;Array.prototype.forEach.call(document.querySelectorAll(".ol-layer canvas"),b=>{if(b.width<0)return;const _=b.parentNode.style.opacity;F.globalAlpha=_===""?1:Number(_),x=b.style.transform.match(/^matrix\(([^(]*)\)$/)[1].split(",").map(Number),CanvasRenderingContext2D.prototype.setTransform.apply(F,x),F.drawImage(b,0,0)});const O=document.querySelector(".ol-fixedoverlay");O&&F.drawImage(O,0,0),CanvasRenderingContext2D.prototype.setTransform.apply(F,[1,0,0,1,0,0]),V.toBlob(async b=>{if(b)if(h){const _=We.createWriteStream("map.png",{size:b.size});await new Response(b).body?.pipeTo(_)}else await navigator.clipboard.write([new ClipboardItem({"image/png":Promise.resolve(b)})]),o.setMessage("Copied to clipboard map image.")},"image/png",.9)}),n.renderSync(),o.setLoading(!1)};return l({show:h=>{f.map&&h&&(S.value={x:h.clientX,y:h.clientY},w.value=f.map.getEventCoordinate(h)),s.value=!0},hide:()=>{s.value=!1},position:S,coordinate:w}),(h,n)=>(B(),j(jt,{modelValue:s.value,"onUpdate:modelValue":n[2]||(n[2]=d=>s.value=d),absolute:"",style:ot(`top: ${S.value.y}px; left: ${S.value.x}px`)},{default:t(()=>[e(Gt,{density:"compact"},{default:t(()=>[e(Dt,null,{default:t(()=>[e(K,{size:"small"},{default:t(()=>n[3]||(n[3]=[c("mdi-crosshairs")])),_:1,__:[3]}),n[7]||(n[7]=c(" Coordinate ")),e(K,{size:"small"},{default:t(()=>n[4]||(n[4]=[c("mdi-arrow-left-right")])),_:1,__:[4]}),c(" "+ee(w.value[0].toFixed(6))+", ",1),e(K,{size:"small"},{default:t(()=>n[5]||(n[5]=[c("mdi-arrow-up-down")])),_:1,__:[5]}),c(" "+ee(w.value[1].toFixed(6))+"   ",1),e(K,{size:"small"},{default:t(()=>n[6]||(n[6]=[c("mdi-magnify")])),_:1,__:[6]}),c(" Zoom: "+ee(Math.round(A.value)),1)]),_:1,__:[7]}),e(de,{"prepend-icon":"mdi-link-variant",title:"Copy link to the clipboard",onClick:k}),e(G),e(de,{"prepend-icon":"mdi-image-marker",title:"Copy the map image to the clipboard",onClick:n[0]||(n[0]=d=>y(!1))}),e(de,{"prepend-icon":"mdi-file-image-marker",title:"Save map image to file",onClick:n[1]||(n[1]=d=>y(!0))})]),_:1})]),_:1},8,["modelValue","style"]))}}),po=J({__name:"ConfirmModal",props:{title:{type:String,required:!0},message:{type:String,default:""},discardable:{type:Boolean,default:!1},danger:{type:Boolean,default:!1}},emits:["submit","cancel","discard"],setup(i,{expose:l,emit:f}){const a=f,o=g(!1),p=g(null),s=k=>{p.value=k,o.value=!0},S=()=>{a("cancel"),p.value=null,o.value=!1},w=()=>{a("discard",p.value),p.value=null,o.value=!1},A=()=>{a("submit",p.value),S()};return l({show:s}),(k,y)=>(B(),j(ae,{modelValue:o.value,"onUpdate:modelValue":y[0]||(y[0]=v=>o.value=v),persistent:"","max-width":"640px",onKeydown:ce(S,["esc"])},{default:t(()=>[e(le,{title:i.title,subtitle:i.message},{append:t(()=>[e(T,{text:"Close"},{activator:t(({props:v})=>[e(C,E(v,{icon:"mdi-close",variant:"plain",onClick:S}),null,16)]),_:1})]),default:t(()=>[e(ne,null,{default:t(()=>[i.discardable?(B(),j(C,{key:0,color:"orange","prepend-icon":"mdi-undo-variant",variant:"plain",onClick:w},{default:t(()=>y[1]||(y[1]=[c(" Discard ")])),_:1,__:[1]})):ve("",!0),e(H),i.danger?(B(),j(C,{key:1,color:"red","prepend-icon":"mdi-close-octagon",variant:"text",onClick:A},{default:t(()=>y[2]||(y[2]=[c(" OK ")])),_:1,__:[2]})):ve("",!0),e(C,{variant:"text",color:"secondary","prepend-icon":"mdi-cancel",onClick:S},{default:t(()=>y[3]||(y[3]=[c(" Cancel ")])),_:1,__:[3]}),i.danger?ve("",!0):(B(),j(C,{key:2,variant:"text",color:"primary","prepend-icon":"mdi-check",onClick:A},{default:t(()=>y[4]||(y[4]=[c(" OK ")])),_:1,__:[4]}))]),_:1})]),_:1},8,["title","subtitle"])]),_:1},8,["modelValue"]))}}),mo=["red","pink","purple","deep-purple","indigo","blue","light-blue","cyan","teal","green","light-green","lime","yellow","amber","orange","deep-orange","brown","blue-grey","grey"],fo=J({__name:"PropertiesEditorModal",emits:["submit","delete"],setup(i,{expose:l,emit:f}){const a=f,o=De(),p=g(!1),s=g(oe),S=g(),w=g("basic"),A=g(!0);te(p,h=>{h||(S.value=void 0,s.value=oe)});const k=h=>{p.value=!0,S.value=h,s.value=h.getProperties(),A.value=h.getGeometry().flatCoordinates.length===2},y=()=>{p.value=!1,s.value=oe},v=()=>{S.value&&(S.value.setProperties(s.value),a("submit",S.value)),p.value=!1},I=()=>{a("delete",S.value),p.value=!1};return te(p,h=>{h||(w.value="basic",s.value.description="")}),l({show:k}),(h,n)=>(B(),j(ae,{modelValue:p.value,"onUpdate:modelValue":n[9]||(n[9]=d=>p.value=d),persistent:"","max-width":"1024px",onKeydown:ce(y,["esc"])},{default:t(()=>[e(le,{title:"Edit Properties",subtitle:"Edit the properties of the selected feature."},{append:t(()=>[e(T,{text:"Close"},{activator:t(({props:d})=>[e(C,E(d,{icon:"mdi-close",variant:"plain",onClick:y}),null,16)]),_:1})]),default:t(()=>[e(Ce,null,{default:t(()=>[e(Nt,{modelValue:w.value,"onUpdate:modelValue":n[0]||(n[0]=d=>w.value=d)},{default:t(()=>[e(Ee,{value:"basic","prepend-icon":"mdi-information"},{default:t(()=>n[10]||(n[10]=[c("Basic")])),_:1,__:[10]}),e(Ee,{value:"description","prepend-icon":"mdi-message-text"},{default:t(()=>n[11]||(n[11]=[c("Description")])),_:1,__:[11]})]),_:1},8,["modelValue"]),e(Jt,{modelValue:w.value,"onUpdate:modelValue":n[8]||(n[8]=d=>w.value=d)},{default:t(()=>[e(Te,{value:"basic"},{default:t(()=>[e(Wt,null,{default:t(()=>[e(X,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:s.value.name,"onUpdate:modelValue":n[1]||(n[1]=d=>s.value.name=d),label:"name",hint:"The name that pops up when you click a feature.","prepend-icon":"mdi-map-marker"},null,8,["modelValue"])]),_:1}),e(X,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:s.value.annotation,"onUpdate:modelValue":n[2]||(n[2]=d=>s.value.annotation=d),label:"Annotation",hint:"Text to display directly above the feature.","prepend-icon":"mdi-form-textbox"},null,8,["modelValue"])]),_:1}),e(X,{cols:"12",md:"3"},{default:t(()=>[e(qt,{modelValue:s.value.color,"onUpdate:modelValue":n[3]||(n[3]=d=>s.value.color=d),items:D(mo),label:"Feature Color","prepend-icon":"mdi-palette"},{item:t(({props:d,item:V})=>[e(de,E(d,{title:V.title}),{prepend:t(()=>[e(K,{color:V.value},{default:t(()=>[c(" mdi-checkbox-"+ee(V.value===s.value.color?"marked":"blank"),1)]),_:2},1032,["color"])]),_:2},1040,["title"])]),selection:t(({item:d})=>[e(K,{color:d.value},{default:t(()=>n[12]||(n[12]=[c("mdi-checkbox-blank")])),_:2,__:[12]},1032,["color"]),c(" "+ee(d.title),1)]),_:1},8,["modelValue","items"])]),_:1}),e(X,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(z,{modelValue:s.value.thickness,"onUpdate:modelValue":n[4]||(n[4]=d=>s.value.thickness=d),modelModifiers:{number:!0},label:"Feature line thickness",hint:" If set to 0, only annotations will be displayed.",type:"number",minimum:"0","prepend-icon":"mdi-format-line-weight",suffix:"px"},null,8,["modelValue"])]),_:1}),e(X,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(z,{modelValue:s.value.annotationStyle,"onUpdate:modelValue":n[5]||(n[5]=d=>s.value.annotationStyle=d),label:"Annotation Text style",hint:"Set font weight and font-size. Default is `500 0.75rem`.",placeholder:"500 0.75rem","prepend-icon":"mdi-format-font"},null,8,["modelValue"])]),_:1}),e(X,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(z,{modelValue:s.value.opacity,"onUpdate:modelValue":n[6]||(n[6]=d=>s.value.opacity=d),modelModifiers:{number:!0},label:"Fill Opacity",hint:"Transparency of fills in Point and Polygons (0 to 1)",type:"number",minimum:"0",maximum:"1","prepend-icon":"mdi-opacity",step:"0.1"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Te,{value:"description"},{default:t(()=>[e(Qt,{hint:"The text to display in the popup. You can use Markdown notation.","persistent-hint":""},{default:t(()=>[e(D(Je),{modelValue:s.value.description,"onUpdate:modelValue":n[7]||(n[7]=d=>s.value.description=d),lang:D($t)(),dark:D(o).current.value.dark,gutter:"",wrap:"",basic:""},null,8,["modelValue","lang","dark"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ne,null,{default:t(()=>[e(C,{color:"red",variant:"text","prepend-icon":"mdi-delete",onClick:I},{default:t(()=>n[13]||(n[13]=[c("Delate")])),_:1,__:[13]}),e(H),e(C,{color:"secondary",variant:"text","prepend-icon":"mdi-cancel",onClick:y},{default:t(()=>n[14]||(n[14]=[c(" Cancel ")])),_:1,__:[14]}),e(C,{color:"primary",variant:"text","prepend-icon":"mdi-check",onClick:v},{default:t(()=>n[15]||(n[15]=[c("Save")])),_:1,__:[15]})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),vo=J({__name:"ExportModal",setup(i,{expose:l}){const f=N(),a=pe(),o=g(!1),p=g("geojson"),s=g(!1),S=g("export-"+new Date().toLocaleDateString()),w=()=>o.value=!0,A=()=>o.value=!1,k=async()=>{f.setLoading(!0),await Y();const y=a.exportBlob(p.value,s.value),v=We.createWriteStream(`${S.value}.json`,{size:y.size});await new Response(y).body?.pipeTo(v),f.setLoading(!1),A()};return l({show:w}),(y,v)=>(B(),j(ae,{modelValue:o.value,"onUpdate:modelValue":v[3]||(v[3]=I=>o.value=I),"max-width":"480px",onKeydown:ce(A,["esc"])},{default:t(()=>[e(le,{title:"Export",subtitle:"Import a local GeoJSON / TopoJSON file."},{append:t(()=>[e(T,{text:"Close"},{activator:t(({props:I})=>[e(C,E(I,{icon:"mdi-close",variant:"plain",onClick:A}),null,16)]),_:1})]),default:t(()=>[e(Ce,null,{default:t(()=>[e(Xt,{modelValue:p.value,"onUpdate:modelValue":v[0]||(v[0]=I=>p.value=I),label:"File Type",inline:""},{default:t(()=>[e(Pe,{label:"GeoJson",value:"geojson"}),e(Pe,{label:"TopoJson",value:"topojson"})]),_:1},8,["modelValue"]),e(z,{modelValue:S.value,"onUpdate:modelValue":v[1]||(v[1]=I=>S.value=I),"prepend-icon":"mdi-file-download-outline",label:"Filename",suffix:`.${p.value}`,"hide-details":""},null,8,["modelValue","suffix"]),e(zt,{modelValue:s.value,"onUpdate:modelValue":v[2]||(v[2]=I=>s.value=I),label:"Compress"},null,8,["modelValue"])]),_:1}),e(ne,null,{default:t(()=>[e(H),e(C,{variant:"text",color:"secondary","prepend-icon":"mdi-cancel",onClick:A},{default:t(()=>v[4]||(v[4]=[c(" Cancel ")])),_:1,__:[4]}),e(C,{variant:"text",color:"primary","prepend-icon":"mdi-file-download",onClick:k},{default:t(()=>v[5]||(v[5]=[c(" Save ")])),_:1,__:[5]})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),yo=J({__name:"ImportModal",emits:["loaded"],setup(i,{expose:l,emit:f}){const a=f,o=N(),p=pe(),s=U({get:()=>o.loading,set:V=>o.setLoading(V)}),S=U({get:()=>o.progress,set:V=>o.setProgress(V)}),w=g(),A=g(!1),k=g([]),y=g(!1),v=new FileReader;v.onloadstart=V=>{s.value=!0,V.lengthComputable&&(S.value=Math.round(V.loaded/V.total*100))},v.onloadend=()=>{S.value=100,s.value=!1};const I=g(!1),h=()=>I.value=!0,n=()=>I.value=!1,d=async()=>{if(s.value=!0,A.value=!1,!w.value)return;const V=new FileReader;V.readAsText(w.value),V.onload=async()=>{const F=V.result;let x;try{x=JSON.parse(F)}catch{A.value=!0,k.value=["GeoJson parse error."];return}if(x.type==="Topology")try{x=Bt(x,"data")}catch{A.value=!0,k.value=["Topojson parse error."],s.value=!1;return}y.value&&(x=Ge(x)),x.type==="FeatureCollection"&&x.features.forEach(O=>(O.id=xe(),O)),p.setGeoJson(x),p.setRefresh(!0),A.value=!1,w.value=void 0,s.value=!1,a("loaded"),await Y(),n(),o.setMessage("GeoJson loaded successfully.")}};return l({show:h,hide:n}),(V,F)=>(B(),j(ae,{modelValue:I.value,"onUpdate:modelValue":F[2]||(F[2]=x=>I.value=x),"max-width":"480px",onKeydown:ce(n,["esc"])},{default:t(()=>[e(le,null,{title:t(()=>F[3]||(F[3]=[c("Import")])),append:t(()=>[e(T,{text:"Close"},{activator:t(({props:x})=>[e(C,E(x,{icon:"mdi-close",variant:"plain",onClick:n}),null,16)]),_:1})]),default:t(()=>[e(Ne,null,{default:t(()=>F[4]||(F[4]=[c("Import a local GeoJSON / TopoJSON file.")])),_:1,__:[4]}),e(Ce,null,{default:t(()=>[e(Yt,{modelValue:w.value,"onUpdate:modelValue":F[0]||(F[0]=x=>w.value=x),"show-size":"",required:"",placeholder:"Choose a GeoJSON file.",label:"GeoJson","prepend-icon":"mdi-paperclip",accept:"application/geo+json",onEmptied:F[1]||(F[1]=x=>w.value=void 0)},null,8,["modelValue"])]),_:1}),e(ne,null,{default:t(()=>[e(H),e(C,{color:"secondary","prepend-icon":"mdi-cancel",variant:"text",onClick:n},{default:t(()=>F[5]||(F[5]=[c(" Cancel ")])),_:1,__:[5]}),e(C,{color:"primary","prepend-icon":"mdi-check",variant:"text",onClick:d},{default:t(()=>F[6]||(F[6]=[c("OK")])),_:1,__:[6]})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),go=J({__name:"SourceModal",emits:{close:()=>!0},setup(i,{expose:l,emit:f}){const a=f,o=pe(),p=De(),s=g(),S=g(),w=g(),A=g(p.current.value.dark),k=g(!1),y=g(JSON.stringify(o.geojson,null,2)),v=g(0),I=()=>{k.value=!0,y.value=JSON.stringify(o.geojson,null,2)},h=()=>{try{const x=JSON.parse(y.value);o.setGeoJson(x)}catch{return}o.setRefresh(!0),n()},n=()=>{a("close"),k.value=!1},d=()=>S.value?.show(),V=()=>s.value?.show(),F=()=>y.value=JSON.stringify(o.geojson,null,2);return l({show:I}),(x,O)=>(B(),j(ae,{modelValue:k.value,"onUpdate:modelValue":O[1]||(O[1]=b=>k.value=b),fullscreen:"",transition:"dialog-bottom-transition"},{default:t(()=>[e(le,{class:"d-flex flex-column"},{title:t(()=>O[2]||(O[2]=[c("Source")])),append:t(()=>[e(T,{text:"Close"},{activator:t(({props:b})=>[e(C,E(b,{icon:"mdi-close",variant:"plain",onClick:n}),null,16)]),_:1})]),default:t(()=>[e(Ne,{class:"flex-grow-0",style:{"flex-basis":"auto"}},{default:t(()=>O[3]||(O[3]=[c("Geojson source")])),_:1,__:[3]}),e(D(Je),{ref_key:"editor",ref:w,modelValue:y.value,"onUpdate:modelValue":O[0]||(O[0]=b=>y.value=b),dark:A.value,lang:D(to)(),linter:D(eo)(),basic:"",class:"flex-grow-1",gutter:"",style:{"flex-basis":"0","overflow-y":"scroll"},wrap:""},null,8,["modelValue","dark","lang","linter"]),e(ne,{class:"flex-grow-0",style:{"flex-basis":"auto"}},{default:t(()=>[e(C,{color:"orange","prepend-icon":"mdi-upload",variant:"text",onClick:d},{default:t(()=>O[4]||(O[4]=[c(" Import ")])),_:1,__:[4]}),e(C,{disabled:v.value!==0,color:"green","prepend-icon":"mdi-download",variant:"text",onClick:V},{default:t(()=>O[5]||(O[5]=[c(" Export ")])),_:1,__:[5]},8,["disabled"]),e(H),e(C,{color:"secondary","prepend-icon":"mdi-cancel",variant:"text",onClick:n},{default:t(()=>O[6]||(O[6]=[c(" Cancel ")])),_:1,__:[6]}),e(C,{disabled:w.value?.diagnosticCount!==0,color:"primary","prepend-icon":"mdi-check",variant:"text",onClick:h},{default:t(()=>O[7]||(O[7]=[c(" OK ")])),_:1,__:[7]},8,["disabled"])]),_:1})]),_:1}),e(yo,{ref_key:"importModal",ref:S,onLoaded:F},null,512),e(vo,{ref_key:"exportModal",ref:s},null,512)]),_:1},8,["modelValue"]))}});function So(i,l,f=2,a){const o=l.getSource();if(o)switch(i){case"translate":return new It({features:a,hitTolerance:f});case"modify":return new Ot({source:o});case"delete":return new Ft({layers:[l]});case"point":return new ge({source:o,type:"Point"});case"line":return new ge({source:o,type:"LineString"});case"square":return new Oe({source:o,sides:4,canRotate:!0});case"circle":return new Oe({source:o,sides:2,canRotate:!1});case"polygon":return new ge({source:o,type:"Polygon"});case"transform":{ye.prototype.Cursors.rotate="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXAgMAAACdRDwzAAAAAXNSR0IArs4c6QAAAAlQTFRF////////AAAAjvTD7AAAAAF0Uk5TAEDm2GYAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH2wwSEgUFmXJDjQAAAEZJREFUCNdjYMAOuCCk6goQpbp0GpRSAFKcqdNmQKgIILUoNAxIMUWFhoKosNDQBKDgVAilCqcaQBogFFNoGNjsqSgUTgAAM3ES8k912EAAAAAASUVORK5CYII=') 5 5, auto",ye.prototype.Cursors.rotate0="url('data:image/png;base64,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') 5 5, auto";const p=new ye({enableRotatedTransform:!1,addCondition:Vt,layers:[l],hitTolerance:f,translateFeature:!0,scale:!0,rotate:!0,keepRectangle:!1,translate:!0,stretch:!0});return p.on(["select"],s=>{}),p}case"fill":return new ht({name:"fill color"},{color:"red"});case"hole":{const p=new bt({layers:[l],type:"Polygon"});return o.removeFeature(p.getPolygon()),p}}}const Vo=J({__name:"HomeView",setup(i){const l=N(),f=ke(),a=pe(),o=g(),p=g(),s=g(),S=g(),w=g(),A=g(!1),k=g("default"),y=g(2),v=g(!1),I=U({get:()=>l.message,set:m=>l.setMessage(m)}),h=U({get:()=>a.requestRefresh,set:m=>a.setRefresh(m)}),n=U({get:()=>l.loading,set:m=>l.setLoading(m)}),d=U({get:()=>f.level,set:m=>f.setLevel(m)}),V=U({get:()=>a.getFeatures(),set:m=>a.setFeatures(m)}),F=new ue({properties:{id:"locationLayer"},zIndex:5}),x=new we({features:V.value}),O=new ue({source:x,style:m=>Ae(m),zIndex:10,properties:{id:"editorLayer"}}),b=new je({condition:m=>m.type===Et.SINGLECLICK,layers:[O],hitTolerance:y.value,style:m=>Ae(m,P.SELECTED),multi:!1}),_=new Tt({source:x});let L;const me=new Pt;te(()=>k.value,m=>{const r=o.value?.map;!r||!m||(b.getFeatures().clear(),!(L&&(r.removeInteraction(L),m==="default"))&&(v.value?r.removeInteraction(_):r.addInteraction(_),L=So(m,O,y.value,b.getFeatures()),L&&(L.on("drawend",u=>{const R=oe;return u.feature.setId(xe()),u.feature.setProperties(R),k.value="translate",u}),L.on("change",u=>{}),L.on("error",u=>{}),L.on("propertychange",u=>{}),r.addInteraction(L))))}),te(()=>d.value,m=>{const r=o.value?.map;if(!r)return;const u=r.getLayers();u.forEach(R=>(R instanceof ue&&Le(R,m),R)),r.setLayers(u)}),te(()=>I.value,m=>o.value?.notification.show(m));const be=async()=>{!o.value?.map||!h.value||(x.clear(),x.addFeatures(V.value),O.setSource(x),await Y())},fe=()=>b.getFeatures().clear(),qe=async m=>{const r=m.getId();if(!r)return;const u=x.getFeatureById(r);u&&(u.setProperties(m.getProperties()),await Y(),V.value=x.getFeatures(),h.value=!0,fe())},Qe=async m=>{const r=m.getId();if(!r)return;const u=x.getFeatureById(r);u&&(x.removeFeature(u),fe(),V.value=x.getFeatures(),h.value=!0,await Y())},Xe=()=>{V.value=x.getFeatures(),S.value?.show()},ze=()=>w.value?.show(),Ye=()=>{a.clear(),be()},Ke=()=>{const m=o.value?.map;m&&(v.value?m.removeInteraction(_):m.addInteraction(_),v.value=!v.value)};Be(async()=>{const m=o.value?.map;m&&(n.value=!0,F.setSource(new we({features:V.value})),Le(F,d.value),m.addLayer(F),m.addLayer(O),m.addInteraction(me),m.addInteraction(b),b.on("select",async r=>{if(k.value!=="edit")return;const u=r.selected[0].getId();if(!u)return;const R=x.getFeatureById(u);R&&s.value?.show(R)}),n.value=!1)});const Ze=m=>{o.value?.map&&p.value?.show(m)};return lt(()=>{const m=o.value?.map;m&&L&&m.addInteraction(L)}),nt(async(m,r,u)=>{m.params.region!==r.params.region&&(A.value=!1),u(),await Y(),m.params.region!==r.params.region&&(A.value=!0)}),(m,r)=>(B(),j(Ht,{fluid:"",class:"px-0 py-0 d-flex flex-column h-100"},{default:t(()=>[e(Zt,{color:"primary",dense:"",elevation:"2"},{default:t(()=>[e(Kt,{modelValue:k.value,"onUpdate:modelValue":r[0]||(r[0]=u=>k.value=u),class:"px-0",variant:"text",theme:"dark"},{default:t(()=>[e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-cursor-default",tile:"",value:"default"},u),null,16)]),default:t(()=>[r[3]||(r[3]=c(" Default "))]),_:1,__:[3]}),e(G,{vertical:""}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-vector-point-select",tile:"",value:"edit"},u),null,16)]),default:t(()=>[r[4]||(r[4]=c(" Edit Properties "))]),_:1,__:[4]}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-arrow-all",tile:"",value:"translate"},u),null,16)]),default:t(()=>[r[5]||(r[5]=c(" Move "))]),_:1,__:[5]}),e(G,{vertical:""}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-vector-polyline-edit",tile:"",value:"modify"},u),null,16)]),default:t(()=>[r[6]||(r[6]=c(" Modify (Alt + Click to delete point.) "))]),_:1,__:[6]}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-vector-square-edit",tile:"",value:"transform"},u),null,16)]),default:t(()=>[r[7]||(r[7]=c(" Rotate "))]),_:1,__:[7]}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-vector-square-remove",tile:"",value:"delete"},u),null,16)]),default:t(()=>[r[8]||(r[8]=c(" Delete "))]),_:1,__:[8]}),e(G,{vertical:""}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-vector-point-plus",tile:"",value:"point"},u),null,16)]),default:t(()=>[r[9]||(r[9]=c(" Point "))]),_:1,__:[9]}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-vector-line",tile:"",value:"line"},u),null,16)]),default:t(()=>[r[10]||(r[10]=c(" Line "))]),_:1,__:[10]}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-vector-polygon",tile:"",value:"polygon"},u),null,16)]),default:t(()=>[r[11]||(r[11]=c(" Polygon "))]),_:1,__:[11]}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-vector-difference",tile:"",value:"hole"},u),null,16)]),default:t(()=>[r[12]||(r[12]=c(" Draw Hole "))]),_:1,__:[12]}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-vector-square",tile:"",value:"square"},u),null,16)]),default:t(()=>[r[13]||(r[13]=c(" Square "))]),_:1,__:[13]}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-vector-circle",tile:"",value:"circle"},u),null,16)]),default:t(()=>[r[14]||(r[14]=c(" Circle "))]),_:1,__:[14]}),e(G,{vertical:""}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-format-color-fill",tile:"",value:"fill"},u),null,16)]),default:t(()=>[r[15]||(r[15]=c(" Fill "))]),_:1,__:[15]})]),_:1},8,["modelValue"]),e(G,{vertical:""}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:`mdi-grid${v.value?"":"-off"}`,tile:""},u,{onClick:Ke}),null,16,["icon"])]),default:t(()=>[r[16]||(r[16]=c(" Snap "))]),_:1,__:[16]}),e(G,{vertical:""}),e(H),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-undo",tile:""},u,{onClick:r[1]||(r[1]=R=>D(me).undo())}),null,16)]),default:t(()=>[r[17]||(r[17]=c(" Undo "))]),_:1,__:[17]}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-redo",tile:""},u,{onClick:r[2]||(r[2]=R=>D(me).redo())}),null,16)]),default:t(()=>[r[18]||(r[18]=c(" Redo "))]),_:1,__:[18]}),e(G,{vertical:""}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-delete",tile:""},u,{onClick:ze}),null,16)]),default:t(()=>[r[19]||(r[19]=c(" Clear "))]),_:1,__:[19]}),e(G,{vertical:""}),e(T,{location:"bottom"},{activator:t(({props:u})=>[e(C,E({icon:"mdi-code-json",tile:""},u,{onClick:Xe}),null,16)]),default:t(()=>[r[20]||(r[20]=c(" Geojson Source "))]),_:1,__:[20]}),e(po,{ref_key:"confirmModal",ref:w,title:"Clear",message:"Are you sure you want to remove all pins?",danger:"",onSubmit:Ye},null,512),e(fo,{ref_key:"propertiesModal",ref:s,onSubmit:qe,onDelete:Qe,onCancel:fe},null,512),e(go,{ref_key:"codeModal",ref:S,onClose:be},null,512)]),_:1}),e(uo,{ref_key:"mapComponent",ref:o,onContextmenu:Ze},null,512),e(co,{ref_key:"mapContextMenu",ref:p,map:o.value?.map},null,8,["map"])]),_:1}))}});export{Vo as default};
