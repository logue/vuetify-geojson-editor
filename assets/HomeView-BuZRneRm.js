import{u as W}from"./index-DsQ1aXLG.js";import{W as Re,h as B,d as h,j as N,a7 as Xe,s as Ye,B as Ue,a8 as ze,a0 as Be,_ as U,Z as z,J as Ze,$ as t,n as e,V as v,O as te,a9 as Ke,aa as ce,a2 as oe,v as _,w as q,u as E,ab as De,H as ve,m as He,I as $e,F as et,ac as tt}from"./vue-CXjSzwHK.js";import{G as ke,e as O,F as R,f as T,A as D,E as we,h as ot,o as at,n as Ce,J as lt,t as nt,K as rt,V as ge,b as Ge,M as it,Z as st,N as ut,O as ct,Q as dt,U as pt,T as de,a as mt,W as ft,X as Ve,Y as gt,_ as yt,$ as vt,a0 as wt,S as We,a1 as St,a2 as xt,a3 as ht,a4 as Ie,D as pe,a5 as At,a6 as bt}from"./ol-D2mnnKdr.js";import{o as kt,a as Fe,b as Ct,c as Vt,d as It,e as Ft,f as Ot,g as me,h as Oe,i as Et}from"./ol-ext-_m0hHfDA.js";import{t as Ee,v as Se,g as Ne,h as Tt,i as Pt,j,l as H,m as _t,S as Je,n as Mt}from"./vendor-BkUk8B2d.js";import{t as Lt,v as jt,x as Rt,y as K,c as ue,b as G,a as Ut,z as le,A as ne,B as re,V as k,j as $,C as M,u as qe,D as xe,E as zt,F as Te,G as Bt,H as Pe,I as Dt,J as X,K as Z,L as Gt,M as Wt,N as Nt,O as _e,P as Jt,Q as Qe,R as qt,S as Qt,T as Xt,U as Yt}from"./vuetify-DmV6SFKZ.js";import{h as Zt,j as Kt,n as Ht}from"./codemirror-D4iGXp2G.js";import"./lezer-Dbvk8yar.js";const ae={id:void 0,name:void 0,description:void 0,annotation:void 0,annotationStyle:void 0,icon:void 0,color:"light-blue",opacity:void 0,thickness:void 0,level:0},ee=Re("geojson-editor",()=>{const r=B(()=>new ke().readFeatures(o.value,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})),o=h({type:"FeatureCollection",features:[]}),n=B(()=>Ee({data:o.value})),l=h(!0);function a(p){let A=0;p.forEach(g=>{A++,g.getId()||g.setId(Se());let c=g.getProperties();c||(c=ae,c.no=A),g.setProperties(c)}),o.value=JSON.parse(new ke().writeFeatures(p,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}))}function u(p="geojson",A=!1,g=!1){o.value.type==="FeatureCollection"&&o.value.features.forEach(b=>(delete b.id,b));let c=Ne(o.value);g&&(c=Tt(c));const x=JSON.stringify(p==="topojson"?{$schema:"https://raw.githubusercontent.com/Casyfill/TopoJSON_schema/master/topology.json",...Ee({data:c})}:{$schema:"https://json.schemastore.org/geojson.json",...c},null,A?2:0);return new Blob([x],{type:"application/geo+json"})}function s(p){o.value=p}function f(){o.value={type:"FeatureCollection",features:[]},l.value=!0}function w(p=!0){l.value=p}return{features:r,geojson:o,topojson:n,requestRefresh:l,exportBlob:u,setGeoJson:s,setFeatures:a,clear:f,setRefresh:w}},{persist:{storage:window.localStorage}}),he=Re("map-cursor",()=>{const r=h([0,0]),o=h(1),n=h(0);function l(s){r.value=s}function a(s){o.value=s}function u(s){n.value=s}return{level:n,zoom:o,coordinate:r,setCoordinate:l,setZoom:a,setLevel:u}}),$t="https://maps.gsi.go.jp/vector/sprite/std.json",eo="https://maps.gsi.go.jp/vector/sprite/std.png",to=[5,5],oo=new Map([[1401,"都道府県所在地-20"],[1402,"市役所・東京都の区役所-20"],[1403,"町村役場・政令指定都市の区役所-20"],[3201,"官公署"],[3202,"裁判所"],[3205,"市役所・東京都の区役所"],[3206,"町村役場・政令指定都市の区役所"],[3211,"交番"],[3212,"高等学校・中等教育学校"],[3214,"小学校"],[3213,"中学校"],[3215,"老人ホーム"],[3216,"博物館法の登録博物館・博物館相当施設"],[3217,"図書館"],[3218,"郵便局"],[3221,"灯台"],[3231,"神社"],[3232,"寺院"],[3241,"警察署"],[3242,"消防署"],[3243,"病院"],[3244,"保健所"],[4101,"煙突"],[4102,"風車"],[4103,"油井・ガス井"],[4104,"記念碑"],[4105,"自然災害伝承碑"],[6301,"墓地"],[6311,"田"],[6312,"畑"],[6313,"茶畑"],[6314,"果樹園"],[6321,"広葉樹林"],[6322,"針葉樹林"],[6323,"竹林"],[6324,"ヤシ科樹林"],[6325,"ハイマツ地"],[6326,"笹地"],[6327,"荒地"],[6331,"温泉"],[6332,"噴火口・噴気口"],[6341,"史跡・名勝・天然記念物"],[6342,"城跡"],[6351,"採鉱地"],[6361,"港湾"],[6362,"漁港"],[6367,"特定重要港-20"],[6368,"重要港-20"],[6371,"国際空港-20"],[6372,"自衛隊等の飛行場-20"],[6375,"国際空港-20"],[6376,"国際空港以外の拠点空港等-20"],[6381,"自衛隊-20"],[7102,"三角点"],[7103,"水準点"],[7101,"電子基準点"],[8103,"発電所等"],[8105,"電波塔"],[51301,"人口100万人以上-500"],[51302,"人口50万-100万人未満-500"],[51303,"人口50万人未満-500"],[56368,"主要な港-500"],[56376,"主要な空港-500"]]),ao=async r=>{try{const o=await fetch(r);return o.ok?await o.json():null}catch{return null}};let ye=null;(async()=>ye=await ao($t))();const lo=r=>{if(!ye)return null;const o=ye[r];if(o){const n=o.y<770?.5:.3;return{src:eo,size:[o.width,o.height],offset:[o.x,o.y],scale:n}}else return null},Me=r=>{if(!r)return;const o=+r,n=oo.get(o)??"指示点",l=lo(n);if(l)return new we(l)},J=(r,o)=>r??o,no=r=>(r.getProperties()?.rnkWidth?+r.getProperties().rnkWidth:1)+1,ro=r=>{switch(r.getProperties()?.rdCtg){case 0:return"rgba(255,190,190,1)";case 1:return"rgba(255,211,111,1)";default:return"rgba(210,210,210,1)"}},io=r=>{const o=r.getProperties();return o?.alti===void 0||o?.alti===null?.5:+o.alti%50===0?1:.5},so=(r,o)=>{const n=[],l=r.getProperties(),a=l?.layer,u=l?.ftCode,s=r.getGeometry()?.getType(),f=l?.alti,w=l?.name,p=l?.knj,A=l?.rdCtg,g=l?.motorway,c=l?.lvOrder,x=l?.railState,b=l?.staCode,i=l?.annoCtg;if(!l)return n;if(a==="waterarea"&&n.push(new O({fill:new R({color:"rgba(220,220,255,1)"})})),(a==="coastline"||a==="river"||a==="lake")&&n.push(new O({stroke:new T({color:"rgba(220,220,255,1)",width:1})})),(a==="building"||a==="structurea")&&(s==="Polygon"||s==="MultiPolygon")&&n.push(new O({fill:new R({color:"rgba(150,150,150,1)"}),zIndex:100})),a==="wstructurea"&&n.push(new O({fill:new R({color:"rgba(255,255,255,1)"}),zIndex:2})),a==="contour"&&(n.push(new O({stroke:new T({color:"rgba(230,230,230,1)",width:io(r)}),zIndex:10})),u===7352&&f!==void 0&&f!==null&&n.push(new O({text:new D({text:String(f),placement:"line",fill:new R({color:"rgba(230,230,230,1)"}),stroke:new T({color:"rgba(255,255,255,1)",width:2})}),zIndex:11}))),a==="boundary"&&(u!==6101?n.push(new O({stroke:new T({color:"rgba(100,0,200,0.3)",width:2,lineDash:[5,3,2,2]}),zIndex:10})):u===6101&&n.push(new O({stroke:new T({color:"rgba(230,230,230,1)",width:1,lineDash:[5,3,2,2]}),zIndex:10}))),a==="road"){const d=no(r),V=ro(r),I=1e3+J(c,0)+10;u!=null&&(u>2710&&u<9999&&g!==1?n.push(new O({stroke:new T({color:V,width:1,lineDash:[2,2]}),zIndex:I-J(A,0)})):u===2701||u===2702?n.push(new O({stroke:new T({color:g===1?"rgba(0,151,0,1)":V,width:d}),zIndex:I-(g===1?0:J(A,0))})):u===2703?n.push(new O({stroke:new T({color:g===1?"rgba(0,151,0,1)":V,width:d}),zIndex:1e4+J(c,0)+1}),new O({stroke:new T({color:"rgba(255,255,255,1)",width:d+2,lineCap:"butt"}),zIndex:1e4+J(c,0)})):u===2704&&n.push(new O({stroke:new T({color:g===1?"rgba(0,151,0,0.5)":V,width:d,lineDash:to,lineCap:"butt"}),zIndex:2e4})))}if(a==="railway"){const d="rgba(100,100,100,1)";x&&([1,2,3,5,100,300].includes(x)?x===1?n.push(new O({stroke:new T({color:d,width:1.5}),zIndex:1e4+J(c,0)+1}),new O({stroke:new T({color:"rgba(255,255,255,1)",width:4,lineCap:"butt"}),zIndex:1e4+J(c,0)})):[2,3,100,300].includes(x)&&n.push(new O({stroke:new T({color:d,width:1.5,lineDash:[5,5]}),zIndex:2e4})):n.push(new O({stroke:new T({color:d,width:1.5}),zIndex:1011}))),b&&b!==0&&n.push(new O({stroke:new T({color:d,width:3}),zIndex:2e4}))}if(a==="symbol"){const d=Me(u);u&&![1401,1402,1403,7101,7102,7103].includes(u)&&d&&n.push(new O({image:d,zIndex:100002})),(w||p)&&d&&n.push(new O({text:new D({text:w??p??"",textAlign:"left",offsetX:8,offsetY:0,fill:new R({color:"rgba(50,50,50,1)"}),stroke:new T({color:"rgba(255,255,255,1)",width:2})}),image:d,zIndex:100004}))}if((a==="symbol"||a==="elevation")&&f){const d=Me(u);d&&n.push(new O({text:new D({text:String(Math.floor(f*10)/10),textAlign:"left",offsetX:8,offsetY:0,fill:new R({color:"rgba(50,50,50,1)"}),stroke:new T({color:"rgba(255,255,255,1)",width:2})}),image:d,zIndex:100003+(7105-J(u,0))}))}return(a==="label"||a==="symbol")&&p&&n.push(new O({text:new D({text:p,fill:new R({color:"rgba(0,0,0,1)"}),stroke:new T({color:"rgba(255,255,255,1)",width:2})}),zIndex:1e5})),a==="transp"&&p&&n.push(new O({text:new D({text:p,fill:new R({color:"rgba(19,97,69,1)"}),stroke:new T({color:"rgba(255,255,255,1)",width:2})}),zIndex:100001})),a==="label"&&p&&i&&[422,421,411,412,413,860,441].includes(i)&&n.push(new O({text:new D({text:p,fill:new R({color:"rgba(19,97,69,1)"}),stroke:new T({color:"rgba(255,255,255,1)",width:2})}),zIndex:100002})),n};class uo{colorSet;fontFace;pointSize;pointFillColor;pointFillOpacity;pointStrokeColor;pointStrokeOpacity;pointStrokeWidth;fillColor;fillOpacity;strokeColor;strokeOpacity;strokeWidth;textColor;textStyle;textOpacity;textStrokeColor;textStrokeOpacity;textStrokeWidth;iconOpacity;iconTextStyle;gridColor;gridOpacity;gridTextStyle;constructor(o="light-blue",n="'Roboto', 'Noto Sans JP','Noto Color Emoji', sans-serif"){this.colorSet=Lt[Pt(o)],this.fontFace=n}getStyle(){return new O({fill:new R({color:j(this.fillColor).alpha(this.fillOpacity).css()}),stroke:new T({color:j(this.strokeColor).alpha(this.strokeOpacity).css(),width:this.strokeWidth}),image:new ot({radius:this.pointSize,stroke:new T({color:j(this.pointStrokeColor).alpha(this.pointStrokeOpacity).css(),width:this.pointStrokeWidth}),fill:new R({color:j(this.pointFillColor).alpha(this.pointFillOpacity).css()})}),text:new D({font:this.textStyle,fill:new R({color:j(this.textColor).alpha(this.textOpacity).css()}),stroke:new T({color:j(this.textStrokeColor).alpha(this.textStrokeOpacity).css(),width:this.textStrokeWidth}),overflow:!0,text:""})})}getIconStyle(o){return new O({image:new we({anchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction",src:`/vuetify-geojson-editor/img/markers/${o}.png`,scale:.75,opacity:this.iconOpacity}),text:new D({offsetX:0,offsetY:10,font:this.textStyle,fill:new R({color:j(this.textColor).alpha(this.textOpacity).css()}),stroke:new T({color:j(this.textStrokeColor).alpha(this.textStrokeOpacity).css(),width:this.textStrokeWidth}),overflow:!0,text:""})})}getLabelStyle(o){return new O({text:new D({font:this.textStyle,fill:new R({color:j(this.textColor).alpha(this.textOpacity).css()}),stroke:new T({color:j(this.textStrokeColor).alpha(this.textStrokeOpacity).css(),width:this.textStrokeWidth}),overflow:!0,offsetY:o,text:""})})}getGridStyle(){return new O({stroke:new T({color:j(this.gridColor).alpha(this.gridOpacity).css()}),text:new D({font:this.gridTextStyle,fill:new R({color:j(this.colorSet.accent2).css()}),stroke:new T({color:j(this.colorSet.lighten1).alpha(this.textStrokeOpacity).css(),width:1})})})}}class Q extends uo{pointFillColor=this.colorSet.accent1||this.colorSet.lighten4;pointFillOpacity=.35;pointStrokeColor=this.colorSet.accent3||this.colorSet.lighten3;pointStrokeOpacity=1;pointStrokeWidth=1;pointSize=5;pointTextStyle=`400 0.3rem ${this.fontFace}`;fillColor=this.colorSet.accent1||this.colorSet.lighten4;fillOpacity=.25;strokeColor=this.colorSet.accent3||this.colorSet.lighten3;strokeOpacity=.75;strokeWidth=1;textColor=this.colorSet.darken4;textStyle=`600 1rem ${this.fontFace}`;textOpacity=1;textStrokeColor=this.colorSet.lighten5;textStrokeOpacity=.5;textStrokeWidth=2.5;iconOpacity=1;iconTextStyle=`500 0.75rem ${this.fontFace}`;gridColor=this.colorSet.base;gridOpacity=.5;gridTextStyle=`900 1.5rem ${this.fontFace}`}class ie extends Q{fillOpacity=0;textStrokeOpacity=.75;textStyle=`600 1.5rem ${this.fontFace}`}class co extends ie{pointFillColor=this.colorSet.accent4||this.colorSet.base;pointFillOpacity=1;pointStrokeColor=this.colorSet.accent2||this.colorSet.lighten4;pointStrokeOpacity=1;pointStrokeWidth=2;fillColor=this.colorSet.accent1||this.colorSet.lighten5;fillOpacity=.25;strokeWidth=3;textStrokeColor=this.colorSet.lighten5;textStrokeOpacity=1}const L={ACTIVE:"active",INACTIVE:"inactive",HOVER:"hover",SELECTED:"selected"};class fe extends Q{}class po extends Q{pointFillOpacity=.5;pointStrokeOpacity=1;fillOpacity=.5;textOpacity=1;strokeOpacity=1;textStrokeOpacity=1}class Le extends Q{pointFillOpacity=.05;pointStrokeOpacity=.25;fillOpacity=.05;strokeOpacity=.25;iconOpacity=.5;textOpacity=.5;textStrokeOpacity=.25}class mo extends ie{}class fo extends ie{textStrokeOpacity=1;textOpacity=1;fillOpacity=.1}class go extends ie{fillOpacity=0;strokeOpacity=.25;textOpacity=.5;textStrokeOpacity=.25}class je extends Q{pointFillColor=this.colorSet.accent4||this.colorSet.base;pointFillOpacity=1;pointStrokeColor=this.colorSet.accent2||this.colorSet.lighten4;pointStrokeOpacity=1;pointStrokeWidth=2;fillColor=this.colorSet.accent1||this.colorSet.lighten5;fillOpacity=.5;strokeWidth=3;textStrokeColor=this.colorSet.lighten5;textStrokeOpacity=1}class se{static fontFace="'Roboto', 'Noto Sans JP','Noto Color Emoji', sans-serif";static getStyle(o,n=L.ACTIVE){let l;switch(n){case L.INACTIVE:l=new Le(o,this.fontFace);break;case L.SELECTED:l=new je(o,this.fontFace);break;case L.HOVER:l=new po(o,this.fontFace);break;case L.ACTIVE:l=new fe(o,this.fontFace);break;default:l=new Q(o,this.fontFace)}return l.getStyle(o)}static getSectionPolygonStyle(o,n=L.ACTIVE){let l;switch(n){case L.INACTIVE:l=new go(o,this.fontFace);break;case L.SELECTED:l=new co(o,this.fontFace);break;case L.HOVER:l=new fo(o,this.fontFace);break;case L.ACTIVE:l=new mo(o,this.fontFace);break;default:l=new ie(o,this.fontFace)}return l.getStyle(o)}static getIconStyle(o="pin",n="blue-grey",l=L.ACTIVE){let a;switch(l){case L.INACTIVE:a=new Le(n,this.fontFace);break;case L.SELECTED:a=new je(n,this.fontFace);break;case L.ACTIVE:a=new fe(n,this.fontFace);break;default:a=new fe(n,this.fontFace)}return a.getIconStyle(o)}static getGridStyle(o="light-blue"){return new Q(o,this.fontFace).getGridStyle()}}H.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";H.defaults.withCredentials=!0;H.defaults.onUploadProgress=r=>{const o=W();r.progress&&r.total?o.setProgress(Math.round(r.loaded*100/r.total)):o.setProgress(null)};H.defaults.onDownloadProgress=r=>{const o=W();r.progress&&r.total?o.setProgress(Math.round(r.loaded*100/r.total)):o.setProgress()};H.interceptors.request.use(r=>(W().setLoading(!0),r));H.interceptors.response.use(r=>(W().setLoading(!1),r),r=>{const o=W();if(o.setLoading(!1),r.response.status>=400)throw o.setMessage("不明なエラーが発生しました。"),new Error(r);return r.response});const yo=new O({image:new we({anchor:[.5,86],anchorXUnits:"fraction",anchorYUnits:"pixels",src:"/vuetify-geojson-editor/img/spotlight-poi2_hdpi.png",crossOrigin:"anonymous",opacity:1,size:[54,86],scale:.5})});function vo(r,o=0,n=0,l=void 0){r&&r.setStyle((a,u)=>{const s=a.getProperties(),f=a.getGeometry(),p=(s.level??0)===o?L.ACTIVE:L.INACTIVE,A=Ae(a,l??p,r.getProperties().id);return f?.getType()==="Point"&&s.icon&&n!==0&&A.getImage()?.setScale(n/u),A})}function Ae(r,o=L.ACTIVE,n){const l=r.getProperties();let a;if(l.icon?(a=se.getIconStyle(l.icon,l.color,o),a.getText()?.setText(l.annotation?.toString())):n==="sectionLayer"&&r.getGeometry()?.getType()==="Polygon"?a=se.getSectionPolygonStyle(l.color,o):a=se.getStyle(l.color,o),o!==L.SELECTED){l.thickness&&a.getStroke()?.setWidth(l.thickness);const u=a.getFill();if(l.opacity&&u){const s=l.opacity,f=j(u.getColor());let w=o===L.ACTIVE?s:s/2;o===L.HOVER&&(w=.25),a.getFill()?.setColor(j(f).alpha(w).css())}}return l.annotation&&!l.icon&&(r.getGeometry()?.getType()==="Point"&&typeof l.annotation!="number"&&a.getImage()?.setOpacity(0),a.getText()?.setText(l.annotation.toString()),l.annotationStyle&&a.getText()?.setFont(`${l.annotationStyle} ${se.fontFace}`)),a}const wo=N({__name:"MapComponent",props:{zoom:{type:Number,default:8},minZoom:{type:Number,default:4},maxZoom:{type:Number,default:18},extentLimit:{type:Array,default:()=>{}},center:{type:Array,default:()=>[139.766667,35.681111]},contextMenu:{type:Boolean,default:!0},loadingMessage:{type:String,default:"Now Loading..."}},emits:["ready","contextmenu"],setup(r,{expose:o,emit:n}){const l=r,a=n,u=Xe(),s=he(),f=h(),w=B({get:()=>s.zoom,set:S=>s.setZoom(S)}),p=B({get:()=>s.coordinate,set:S=>s.setCoordinate(S)}),A=u?.query;A.x&&A.y?p.value=[parseFloat(A.y),parseFloat(A.x)]:l.center&&(p.value=l.center),w.value=A.zoom?parseInt(A.zoom):l.zoom;const g=new at({geometry:new Ce(p.value),name:"cursor"}),c=new lt({center:nt(p.value,"EPSG:4326","EPSG:3857"),projection:"EPSG:3857",zoom:w.value,minZoom:l.minZoom,maxZoom:l.maxZoom,extent:l.extentLimit}),x=new rt;x.setProjection(c.getProjection()),x.setTracking(!0),x.on("change:position",()=>{const S=x.getPosition();g.setGeometry(S?new Ce(S):void 0)});const b=new ge({zIndex:999,style:yo,visible:!0,source:new Ge({features:[g]}),properties:{id:"cursorLayer"}}),i=new kt,d=Ye(new it({controls:[new st,new ut({coordinateFormat:vt(4),projection:"EPSG:4326"}),new ct,new dt({collapsible:!1}),new Fe({label:l.loadingMessage}),new Ct({}),new pt,new Vt,i],view:c,layers:_t([new de({title:"OpenStreetMap",baseLayer:!0,zIndex:1,properties:{id:"osm"},source:new ft,visible:!0}),new de({title:"国土地理院標準地図",baseLayer:!0,zIndex:1,properties:{id:"gsi"},source:new Ve({url:"https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png",attributions:['<a href="https://maps.gsi.go.jp/development/ichiran.html" target="_blank">国土地理院</a>']}),visible:!1}),new mt({title:"国土地理院ベクトルタイル",baseLayer:!0,zIndex:2,properties:{id:"gsi-vector"},source:new gt({format:new yt,url:"https://cyberjapandata.gsi.go.jp/xyz/experimental_bvmap/{z}/{x}/{y}.pbf",maxZoom:17,minZoom:4,attributions:['<a href="https://maps.gsi.go.jp/vector/" target="_blank">地理院地図Vector</a>']}),renderBuffer:100,style:so,visible:!1}),new de({title:"全国最新写真（シームレス）",baseLayer:!1,zIndex:0,properties:{id:"seamlessphoto"},source:new Ve({url:"https://cyberjapandata.gsi.go.jp/xyz/seamlessphoto/{z}/{x}/{y}.jpg",attributions:['<a href="https://maps.gsi.go.jp/development/ichiran.html#seamlessphoto" target="_blank">国土地理院</a>']}),visible:!1}),b])}));d.value.getInteractions().getArray().filter(S=>S instanceof wt)[0].setActive(!1);const F=new We({condition:St,layers:[b]});F.on("select",()=>{}),d.value.addInteraction(F),u?.query.x&&u?.query.y&&b.setVisible(!0),d.value.on("moveend",()=>{const S=d.value.getView(),P=S.getCenter()??l.center;p.value=[P[0],P[1]],w.value=S.getZoom()??0});const m=new Fe({label:l.loadingMessage,layers:d.value.getAllLayers()});return d.value.addControl(m),Ue(()=>{f.value&&(d.value.setTarget(f.value),a("ready",f.value)),d.value.getViewport().addEventListener("contextmenu",S=>{S.preventDefault(),a("contextmenu",S)})}),ze(()=>d.value.setTarget()),o({map:d,notification:i}),(S,P)=>(U(),Be("div",{ref_key:"ol",ref:f,class:"map-component py-0 px-0"},null,512))}}),So=N({__name:"MapContextMenu",props:{map:{type:Object,default:void 0}},setup(r,{expose:o}){const n=r,l=Ke(),a=W(),u=he(),s=h(!1),f=h({x:0,y:0}),w=h([0,0]),p=B(()=>u.zoom),A=async()=>{const b=l.resolve({query:{x:w.value[1].toFixed(6).toString(),y:w.value[0].toFixed(6).toString(),zoom:Math.round(p.value).toString()}});await navigator.clipboard.writeText(location.origin+b.href),a.setMessage("Copied to clipboard this coordinate link url.")},g=async(b=!1)=>{if(!n.map)return;const i=n.map;a.setLoading(!0),i.once("rendercomplete",()=>{const d=i.getSize()??[0,0],V=document.createElement("canvas");V.width=d[0],V.height=d[1];const I=V.getContext("2d");I.fillStyle="#1d3b58",I.fillRect(0,0,V.width,V.height);let F;Array.prototype.forEach.call(document.querySelectorAll(".ol-layer canvas"),S=>{if(S.width<0)return;const P=S.parentNode.style.opacity;I.globalAlpha=P===""?1:Number(P),F=S.style.transform.match(/^matrix\(([^(]*)\)$/)[1].split(",").map(Number),CanvasRenderingContext2D.prototype.setTransform.apply(I,F),I.drawImage(S,0,0)});const m=document.querySelector(".ol-fixedoverlay");m&&I.drawImage(m,0,0),CanvasRenderingContext2D.prototype.setTransform.apply(I,[1,0,0,1,0,0]),V.toBlob(async S=>{if(S)if(b){const P=Je.createWriteStream("map.png",{size:S.size});await new Response(S).body?.pipeTo(P)}else await navigator.clipboard.write([new ClipboardItem({"image/png":Promise.resolve(S)})]),a.setMessage("Copied to clipboard map image.")},"image/png",.9)}),i.renderSync(),a.setLoading(!1)};return o({show:b=>{n.map&&b&&(f.value={x:b.clientX,y:b.clientY},w.value=n.map.getEventCoordinate(b)),s.value=!0},hide:()=>{s.value=!1},position:f,coordinate:w}),(b,i)=>(U(),z(jt,{modelValue:s.value,"onUpdate:modelValue":i[2]||(i[2]=d=>s.value=d),absolute:"",style:Ze(`top: ${f.value.y}px; left: ${f.value.x}px`)},{default:t(()=>[e(Ut,{density:"compact"},{default:t(()=>[e(Rt,null,{default:t(()=>[e(K,{size:"small"},{default:t(()=>i[3]||(i[3]=[v("mdi-crosshairs")])),_:1,__:[3]}),i[7]||(i[7]=v(" Coordinate ")),e(K,{size:"small"},{default:t(()=>i[4]||(i[4]=[v("mdi-arrow-left-right")])),_:1,__:[4]}),v(" "+te(w.value[0].toFixed(6))+", ",1),e(K,{size:"small"},{default:t(()=>i[5]||(i[5]=[v("mdi-arrow-up-down")])),_:1,__:[5]}),v(" "+te(w.value[1].toFixed(6))+"   ",1),e(K,{size:"small"},{default:t(()=>i[6]||(i[6]=[v("mdi-magnify")])),_:1,__:[6]}),v(" Zoom: "+te(Math.round(p.value)),1)]),_:1,__:[7]}),e(ue,{"prepend-icon":"mdi-link-variant",title:"Copy link to the clipboard",onClick:A}),e(G),e(ue,{"prepend-icon":"mdi-image-marker",title:"Copy the map image to the clipboard",onClick:i[0]||(i[0]=d=>g(!1))}),e(ue,{"prepend-icon":"mdi-file-image-marker",title:"Save map image to file",onClick:i[1]||(i[1]=d=>g(!0))})]),_:1})]),_:1},8,["modelValue","style"]))}}),xo=N({__name:"ConfirmModal",props:{title:{type:String,required:!0},message:{type:String,default:""},discardable:{type:Boolean,default:!1},danger:{type:Boolean,default:!1}},emits:["submit","cancel","discard"],setup(r,{expose:o,emit:n}){const l=n,a=h(!1),u=h(null),s=A=>{u.value=A,a.value=!0},f=()=>{l("cancel"),u.value=null,a.value=!1},w=()=>{l("discard",u.value),u.value=null,a.value=!1},p=()=>{l("submit",u.value),f()};return o({show:s}),(A,g)=>(U(),z(le,{modelValue:a.value,"onUpdate:modelValue":g[0]||(g[0]=c=>a.value=c),persistent:"","max-width":"640px",onKeydown:ce(f,["esc"])},{default:t(()=>[e(ne,{title:r.title,subtitle:r.message},{append:t(()=>[e(M,{text:"Close"},{activator:t(({props:c})=>[e(k,_(c,{icon:"mdi-close",variant:"plain",onClick:f}),null,16)]),_:1})]),default:t(()=>[e(re,null,{default:t(()=>[r.discardable?(U(),z(k,{key:0,color:"orange","prepend-icon":"mdi-undo-variant",variant:"plain",onClick:w},{default:t(()=>g[1]||(g[1]=[v(" Discard ")])),_:1,__:[1]})):oe("",!0),e($),r.danger?(U(),z(k,{key:1,color:"red","prepend-icon":"mdi-close-octagon",variant:"text",onClick:p},{default:t(()=>g[2]||(g[2]=[v(" OK ")])),_:1,__:[2]})):oe("",!0),e(k,{variant:"text",color:"secondary","prepend-icon":"mdi-cancel",onClick:f},{default:t(()=>g[3]||(g[3]=[v(" Cancel ")])),_:1,__:[3]}),r.danger?oe("",!0):(U(),z(k,{key:2,variant:"text",color:"primary","prepend-icon":"mdi-check",onClick:p},{default:t(()=>g[4]||(g[4]=[v(" OK ")])),_:1,__:[4]}))]),_:1})]),_:1},8,["title","subtitle"])]),_:1},8,["modelValue"]))}}),ho=["red","pink","purple","deep-purple","indigo","blue","light-blue","cyan","teal","green","light-green","lime","yellow","amber","orange","deep-orange","brown","blue-grey","grey"],Ao=N({__name:"PropertiesEditorModal",emits:["submit","delete"],setup(r,{expose:o,emit:n}){const l=n,a=qe(),u=h(!1),s=h(ae),f=h(),w=h("basic"),p=h(!0);q(u,b=>{b||(f.value=void 0,s.value=ae)});const A=b=>{u.value=!0,f.value=b,s.value=b.getProperties(),p.value=b.getGeometry().flatCoordinates.length===2},g=()=>{u.value=!1,s.value=ae},c=()=>{f.value&&(f.value.setProperties(s.value),l("submit",f.value)),u.value=!1},x=()=>{l("delete",f.value),u.value=!1};return q(u,b=>{b||(w.value="basic",s.value.description="")}),o({show:A}),(b,i)=>(U(),z(le,{modelValue:u.value,"onUpdate:modelValue":i[9]||(i[9]=d=>u.value=d),persistent:"","max-width":"1024px",onKeydown:ce(g,["esc"])},{default:t(()=>[e(ne,{title:"Edit Properties",subtitle:"Edit the properties of the selected feature."},{append:t(()=>[e(M,{text:"Close"},{activator:t(({props:d})=>[e(k,_(d,{icon:"mdi-close",variant:"plain",onClick:g}),null,16)]),_:1})]),default:t(()=>[e(xe,null,{default:t(()=>[e(zt,{modelValue:w.value,"onUpdate:modelValue":i[0]||(i[0]=d=>w.value=d)},{default:t(()=>[e(Te,{value:"basic","prepend-icon":"mdi-information"},{default:t(()=>i[10]||(i[10]=[v("Basic")])),_:1,__:[10]}),e(Te,{value:"description","prepend-icon":"mdi-message-text"},{default:t(()=>i[11]||(i[11]=[v("Description")])),_:1,__:[11]})]),_:1},8,["modelValue"]),e(Bt,{modelValue:w.value,"onUpdate:modelValue":i[8]||(i[8]=d=>w.value=d)},{default:t(()=>[e(Pe,{value:"basic"},{default:t(()=>[e(Dt,null,{default:t(()=>[e(X,{cols:"12",md:"6"},{default:t(()=>[e(Z,{modelValue:s.value.name,"onUpdate:modelValue":i[1]||(i[1]=d=>s.value.name=d),label:"name",hint:"The name that pops up when you click a feature.","prepend-icon":"mdi-map-marker"},null,8,["modelValue"])]),_:1}),e(X,{cols:"12",md:"6"},{default:t(()=>[e(Z,{modelValue:s.value.annotation,"onUpdate:modelValue":i[2]||(i[2]=d=>s.value.annotation=d),label:"Annotation",hint:"Text to display directly above the feature.","prepend-icon":"mdi-form-textbox"},null,8,["modelValue"])]),_:1}),e(X,{cols:"12",md:"3"},{default:t(()=>[e(Gt,{modelValue:s.value.color,"onUpdate:modelValue":i[3]||(i[3]=d=>s.value.color=d),items:E(ho),label:"Feature Color","prepend-icon":"mdi-palette"},{item:t(({props:d,item:V})=>[e(ue,_(d,{title:V.title}),{prepend:t(()=>[e(K,{color:V.value},{default:t(()=>[v(" mdi-checkbox-"+te(V.value===s.value.color?"marked":"blank"),1)]),_:2},1032,["color"])]),_:2},1040,["title"])]),selection:t(({item:d})=>[e(K,{color:d.value},{default:t(()=>i[12]||(i[12]=[v("mdi-checkbox-blank")])),_:2,__:[12]},1032,["color"]),v(" "+te(d.title),1)]),_:1},8,["modelValue","items"])]),_:1}),e(X,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(Z,{modelValue:s.value.thickness,"onUpdate:modelValue":i[4]||(i[4]=d=>s.value.thickness=d),modelModifiers:{number:!0},label:"Feature line thickness",hint:" If set to 0, only annotations will be displayed.",type:"number",minimum:"0","prepend-icon":"mdi-format-line-weight",suffix:"px"},null,8,["modelValue"])]),_:1}),e(X,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(Z,{modelValue:s.value.annotationStyle,"onUpdate:modelValue":i[5]||(i[5]=d=>s.value.annotationStyle=d),label:"Annotation Text style",hint:"Set font weight and font-size. Default is `500 0.75rem`.",placeholder:"500 0.75rem","prepend-icon":"mdi-format-font"},null,8,["modelValue"])]),_:1}),e(X,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(Z,{modelValue:s.value.opacity,"onUpdate:modelValue":i[6]||(i[6]=d=>s.value.opacity=d),modelModifiers:{number:!0},label:"Fill Opacity",hint:"Transparency of fills in Point and Polygons (0 to 1)",type:"number",minimum:"0",maximum:"1","prepend-icon":"mdi-opacity",step:"0.1"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Pe,{value:"description"},{default:t(()=>[e(Wt,{hint:"The text to display in the popup. You can use Markdown notation.","persistent-hint":""},{default:t(()=>[e(E(De),{modelValue:s.value.description,"onUpdate:modelValue":i[7]||(i[7]=d=>s.value.description=d),lang:E(Zt)(),dark:E(a).current.value.dark,gutter:"",wrap:"",basic:""},null,8,["modelValue","lang","dark"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(re,null,{default:t(()=>[e(k,{color:"red",variant:"text","prepend-icon":"mdi-delete",onClick:x},{default:t(()=>i[13]||(i[13]=[v("Delate")])),_:1,__:[13]}),e($),e(k,{color:"secondary",variant:"text","prepend-icon":"mdi-cancel",onClick:g},{default:t(()=>i[14]||(i[14]=[v(" Cancel ")])),_:1,__:[14]}),e(k,{color:"primary",variant:"text","prepend-icon":"mdi-check",onClick:c},{default:t(()=>i[15]||(i[15]=[v("Save")])),_:1,__:[15]})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),bo=N({__name:"ExportModal",setup(r,{expose:o}){const n=W(),l=ee(),a=h(!1),u=h("geojson"),s=h(!1),f=h("export-"+new Date().toLocaleDateString()),w=()=>a.value=!0,p=()=>a.value=!1,A=async()=>{n.setLoading(!0),await ve();const g=l.exportBlob(u.value,s.value),c=Je.createWriteStream(`${f.value}.json`,{size:g.size});await new Response(g).body?.pipeTo(c),n.setLoading(!1),p()};return o({show:w}),(g,c)=>(U(),z(le,{modelValue:a.value,"onUpdate:modelValue":c[3]||(c[3]=x=>a.value=x),"max-width":"480px",onKeydown:ce(p,["esc"])},{default:t(()=>[e(ne,{title:"Export",subtitle:"Import a local GeoJSON / TopoJSON file."},{append:t(()=>[e(M,{text:"Close"},{activator:t(({props:x})=>[e(k,_(x,{icon:"mdi-close",variant:"plain",onClick:p}),null,16)]),_:1})]),default:t(()=>[e(xe,null,{default:t(()=>[e(Nt,{modelValue:u.value,"onUpdate:modelValue":c[0]||(c[0]=x=>u.value=x),label:"File Type",inline:""},{default:t(()=>[e(_e,{label:"GeoJson",value:"geojson"}),e(_e,{label:"TopoJson",value:"topojson"})]),_:1},8,["modelValue"]),e(Z,{modelValue:f.value,"onUpdate:modelValue":c[1]||(c[1]=x=>f.value=x),"prepend-icon":"mdi-file-download-outline",label:"Filename",suffix:`.${u.value}`,"hide-details":""},null,8,["modelValue","suffix"]),e(Jt,{modelValue:s.value,"onUpdate:modelValue":c[2]||(c[2]=x=>s.value=x),label:"Compress"},null,8,["modelValue"])]),_:1}),e(re,null,{default:t(()=>[e($),e(k,{variant:"text",color:"secondary","prepend-icon":"mdi-cancel",onClick:p},{default:t(()=>c[4]||(c[4]=[v(" Cancel ")])),_:1,__:[4]}),e(k,{variant:"text",color:"primary","prepend-icon":"mdi-file-download",onClick:A},{default:t(()=>c[5]||(c[5]=[v(" Save ")])),_:1,__:[5]})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ko=N({__name:"ImportModal",emits:["loaded"],setup(r,{expose:o,emit:n}){const l=n,a=W(),u=ee(),s=B({get:()=>a.loading,set:V=>a.setLoading(V)}),f=B({get:()=>a.progress,set:V=>a.setProgress(V)}),w=h(),p=h(!1),A=h([]),g=h(!1),c=new FileReader;c.onloadstart=V=>{s.value=!0,V.lengthComputable&&(f.value=Math.round(V.loaded/V.total*100))},c.onloadend=()=>{f.value=100,s.value=!1};const x=h(!1),b=()=>x.value=!0,i=()=>x.value=!1,d=async()=>{if(s.value=!0,p.value=!1,!w.value)return;const V=new FileReader;V.readAsText(w.value),V.onload=async()=>{const I=V.result;let F;try{F=JSON.parse(I)}catch{p.value=!0,A.value=["GeoJson parse error."];return}if(F.type==="Topology")try{F=Mt(F,"data")}catch{p.value=!0,A.value=["Topojson parse error."],s.value=!1;return}g.value&&(F=Ne(F)),F.type==="FeatureCollection"&&F.features.forEach(m=>(m.id=Se(),m)),u.setGeoJson(F),u.setRefresh(!0),p.value=!1,w.value=void 0,s.value=!1,l("loaded"),await ve(),i(),a.setMessage("GeoJson loaded successfully.")}};return o({show:b,hide:i}),(V,I)=>(U(),z(le,{modelValue:x.value,"onUpdate:modelValue":I[2]||(I[2]=F=>x.value=F),"max-width":"480px",onKeydown:ce(i,["esc"])},{default:t(()=>[e(ne,null,{title:t(()=>I[3]||(I[3]=[v("Import")])),append:t(()=>[e(M,{text:"Close"},{activator:t(({props:F})=>[e(k,_(F,{icon:"mdi-close",variant:"plain",onClick:i}),null,16)]),_:1})]),default:t(()=>[e(Qe,null,{default:t(()=>I[4]||(I[4]=[v("Import a local GeoJSON / TopoJSON file.")])),_:1,__:[4]}),e(xe,null,{default:t(()=>[e(qt,{modelValue:w.value,"onUpdate:modelValue":I[0]||(I[0]=F=>w.value=F),"show-size":"",required:"",placeholder:"Choose a GeoJSON file.",label:"GeoJson","prepend-icon":"mdi-paperclip",accept:"application/geo+json",onEmptied:I[1]||(I[1]=F=>w.value=void 0)},null,8,["modelValue"])]),_:1}),e(re,null,{default:t(()=>[e($),e(k,{color:"secondary","prepend-icon":"mdi-cancel",variant:"text",onClick:i},{default:t(()=>I[5]||(I[5]=[v(" Cancel ")])),_:1,__:[5]}),e(k,{color:"primary","prepend-icon":"mdi-check",variant:"text",onClick:d},{default:t(()=>I[6]||(I[6]=[v("OK")])),_:1,__:[6]})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Co=N({__name:"SourceModal",emits:{close:()=>!0},setup(r,{expose:o,emit:n}){const l=n,a=ee(),u=qe(),s=h(),f=h(),w=h(),p=h(u.current.value.dark),A=h(!1),g=h(""),c=h(0),x=()=>{A.value=!0,g.value=JSON.stringify(a.geojson,null,2)},b=()=>{try{const F=JSON.parse(g.value);a.setGeoJson(F)}catch{return}a.setRefresh(!0),i()},i=()=>{l("close"),A.value=!1},d=()=>f.value?.show(),V=()=>s.value?.show(),I=()=>g.value=JSON.stringify(a.geojson,null,2);return o({show:x}),(F,m)=>(U(),z(le,{modelValue:A.value,"onUpdate:modelValue":m[1]||(m[1]=S=>A.value=S),fullscreen:"",transition:"dialog-bottom-transition"},{default:t(()=>[e(ne,{class:"d-flex flex-column"},{title:t(()=>m[2]||(m[2]=[v("Source")])),append:t(()=>[e(M,{text:"Close"},{activator:t(({props:S})=>[e(k,_(S,{icon:"mdi-close",variant:"plain",onClick:i}),null,16)]),_:1})]),default:t(()=>[e(Qe,{class:"flex-grow-0",style:{"flex-basis":"auto"}},{default:t(()=>m[3]||(m[3]=[v("Geojson source")])),_:1,__:[3]}),e(E(De),{ref_key:"editor",ref:w,modelValue:g.value,"onUpdate:modelValue":m[0]||(m[0]=S=>g.value=S),dark:p.value,lang:E(Ht)(),linter:E(Kt)(),basic:"",class:"flex-grow-1",gutter:"",style:{"flex-basis":"0","overflow-y":"scroll"},wrap:""},null,8,["modelValue","dark","lang","linter"]),e(re,{class:"flex-grow-0",style:{"flex-basis":"auto"}},{default:t(()=>[e(k,{color:"orange","prepend-icon":"mdi-upload",variant:"text",onClick:d},{default:t(()=>m[4]||(m[4]=[v(" Import ")])),_:1,__:[4]}),e(k,{disabled:c.value!==0,color:"green","prepend-icon":"mdi-download",variant:"text",onClick:V},{default:t(()=>m[5]||(m[5]=[v(" Export ")])),_:1,__:[5]},8,["disabled"]),e($),e(k,{color:"secondary","prepend-icon":"mdi-cancel",variant:"text",onClick:i},{default:t(()=>m[6]||(m[6]=[v(" Cancel ")])),_:1,__:[6]}),e(k,{disabled:w.value?.diagnosticCount!==0,color:"primary","prepend-icon":"mdi-check",variant:"text",onClick:b},{default:t(()=>m[7]||(m[7]=[v(" OK ")])),_:1,__:[7]},8,["disabled"])]),_:1})]),_:1}),e(ko,{ref_key:"importModal",ref:f,onLoaded:I},null,512),e(bo,{ref_key:"exportModal",ref:s},null,512)]),_:1},8,["modelValue"]))}}),Y=ee();function Vo(r){const{map:o,layer:n}=r,l=h("default"),a=h(2),u=h(!1),s=new It,f=new We({condition:m=>m.type===xt.SINGLECLICK,layers:[E(n)],hitTolerance:E(a),style:m=>Ae(m,L.SELECTED),multi:!1}),w=new ht({source:E(n).getSource()});let p;const A=h();f.on("select",m=>{if(E(l)!=="edit"||m.selected.length===0)return;const S=m.selected[0];S&&(A.value=S)}),q(l,m=>{const S=E(o);if(f.getFeatures().clear(),p&&S.removeInteraction(p),m==="default"){p=void 0;return}p=Io(m,E(n),E(a),f.getFeatures()),p&&(p.on("drawend",P=>(g(P.feature),P)),p.on("change",P=>{}),p.on("error",P=>{}),p.on("propertychange",P=>{}),S.addInteraction(p))});const g=m=>{m.setId(Se()),m.setProperties(ae),l.value="translate",x(m)},c=()=>{f.getFeatures().clear(),A.value=void 0},x=m=>{const S=E(n).getSource();if(!S)return;const P=m.getId(),y=P?S.getFeatureById(P):null;y&&(y.setProperties(m.getProperties()),Y.setFeatures(S.getFeatures()),Y.setRefresh(!0)),c()},b=m=>{const S=E(n).getSource();if(!S)return;const P=m.getId(),y=P?S.getFeatureById(P):null;y&&(S.removeFeature(y),Y.setFeatures(S.getFeatures()),Y.setRefresh(!0)),c()},i=()=>{const m=E(n).getSource();m&&(m.clear(),m.addFeatures(Y.features))},d=()=>{Y.clear(),i()},V=()=>u.value=!u.value,I=()=>s.undo(),F=()=>s.redo();return q(o,m=>{m&&(m.addInteraction(s),m.addInteraction(f),u.value?m.addInteraction(w):m.removeInteraction(w))},{immediate:!0}),ze(()=>{const m=E(o);m.removeInteraction(s),m.removeInteraction(f),m.removeInteraction(w),p&&m.removeInteraction(p)}),{selectedTool:l,isSnapEnabled:u,featureToEdit:A,undo:I,redo:F,toggleSnap:V,clearAllFeatures:d,redrawFeatures:i,updateFeature:x,deleteFeature:b,unSelectFeature:c}}function Io(r,o,n,l){const a=o.getSource();if(a)switch(r){case"translate":return new bt({features:l,hitTolerance:n});case"modify":return new At({source:a});case"delete":return new Et({layers:[o],hitTolerance:n});case"point":return new pe({source:a,type:"Point"});case"line":return new pe({source:a,type:"LineString"});case"square":return new Oe({source:a,sides:4,canRotate:!0,clickTolerance:n});case"circle":return new Oe({source:a,sides:2,canRotate:!1,clickTolerance:n});case"polygon":return new pe({source:a,type:"Polygon",clickTolerance:n});case"transform":{me.prototype.Cursors.rotate="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXAgMAAACdRDwzAAAAAXNSR0IArs4c6QAAAAlQTFRF////////AAAAjvTD7AAAAAF0Uk5TAEDm2GYAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH2wwSEgUFmXJDjQAAAEZJREFUCNdjYMAOuCCk6goQpbp0GpRSAFKcqdNmQKgIILUoNAxIMUWFhoKosNDQBKDgVAilCqcaQBogFFNoGNjsqSgUTgAAM3ES8k912EAAAAAASUVORK5CYII=') 5 5, auto",me.prototype.Cursors.rotate0="url('data:image/png;base64,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') 5 5, auto";const u=new me({enableRotatedTransform:!1,addCondition:Ie,layers:[o],hitTolerance:n,translateFeature:!0,scale:!0,rotate:!0,keepAspectRatio:Ie,keepRectangle:!1,translate:!0,stretch:!0});return u.on(["select"],s=>{}),u}case"fill":return new Ot({name:"fill color"},{color:"red"});case"hole":{const u=new Ft({layers:[o],type:"Polygon"});return a.removeFeature(u.getPolygon()),u}}}const Fo=N({__name:"MapEditorToolbar",props:{map:{type:Object,required:!0},layer:{type:Object,required:!0}},setup(r){const o=r,{map:n,layer:l}=He(o),a=ee(),u=B({get:()=>a.features,set:P=>a.setFeatures(P)}),s=h(),f=h(),w=h(),{selectedTool:p,isSnapEnabled:A,featureToEdit:g,undo:c,redo:x,toggleSnap:b,clearAllFeatures:i,redrawFeatures:d,updateFeature:V,deleteFeature:I,unSelectFeature:F}=Vo({map:n,layer:l});q(g,P=>{P&&w.value?.show(P)});const m=()=>{u.value=o.layer.getSource().getFeatures(),s.value?.show()},S=()=>{a.clear(),i()};return(P,y)=>(U(),Be(et,null,[e(Xt,{color:"primary",dense:"",elevation:"2"},{default:t(()=>[e(Qt,{modelValue:E(p),"onUpdate:modelValue":y[0]||(y[0]=C=>$e(p)?p.value=C:null),class:"px-0",variant:"text",theme:"dark"},{default:t(()=>[e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-cursor-default",tile:"",value:"default"},C),null,16)]),default:t(()=>[y[4]||(y[4]=v(" Default "))]),_:1,__:[4]}),e(G,{vertical:""}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-arrow-all",tile:"",value:"translate"},C),null,16)]),default:t(()=>[y[5]||(y[5]=v(" Translate "))]),_:1,__:[5]}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-vector-point-select",tile:"",value:"edit"},C),null,16)]),default:t(()=>[y[6]||(y[6]=v(" Edit Properties "))]),_:1,__:[6]}),e(G,{vertical:""}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-vector-polyline-edit",tile:"",value:"modify"},C),null,16)]),default:t(()=>[y[7]||(y[7]=v(" Modify (Alt + Click to delete point.) "))]),_:1,__:[7]}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-vector-square-edit",tile:"",value:"transform"},C),null,16)]),default:t(()=>[y[8]||(y[8]=v(" Rotate / Scale / Move "))]),_:1,__:[8]}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-vector-square-remove",tile:"",value:"delete"},C),null,16)]),default:t(()=>[y[9]||(y[9]=v(" Delete "))]),_:1,__:[9]}),e(G,{vertical:""}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-vector-point-plus",tile:"",value:"point"},C),null,16)]),default:t(()=>[y[10]||(y[10]=v(" Point "))]),_:1,__:[10]}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-vector-line",tile:"",value:"line"},C),null,16)]),default:t(()=>[y[11]||(y[11]=v(" Line "))]),_:1,__:[11]}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-vector-polygon",tile:"",value:"polygon"},C),null,16)]),default:t(()=>[y[12]||(y[12]=v(" Polygon "))]),_:1,__:[12]}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-vector-difference",tile:"",value:"hole"},C),null,16)]),default:t(()=>[y[13]||(y[13]=v(" Draw Hole "))]),_:1,__:[13]}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-vector-square",tile:"",value:"square"},C),null,16)]),default:t(()=>[y[14]||(y[14]=v(" Square "))]),_:1,__:[14]}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-vector-circle",tile:"",value:"circle"},C),null,16)]),default:t(()=>[y[15]||(y[15]=v(" Circle "))]),_:1,__:[15]}),e(G,{vertical:""}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-format-color-fill",tile:"",value:"fill"},C),null,16)]),default:t(()=>[y[16]||(y[16]=v(" Fill "))]),_:1,__:[16]})]),_:1},8,["modelValue"]),e(G,{vertical:""}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:`mdi-grid${E(A)?"":"-off"}`,tile:""},C,{onClick:E(b)}),null,16,["icon","onClick"])]),default:t(()=>[y[17]||(y[17]=v(" Snap "))]),_:1,__:[17]}),e(G,{vertical:""}),e($),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-undo",tile:""},C,{onClick:y[1]||(y[1]=be=>E(c)())}),null,16)]),default:t(()=>[y[18]||(y[18]=v(" Undo "))]),_:1,__:[18]}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-redo",tile:""},C,{onClick:y[2]||(y[2]=be=>E(x)())}),null,16)]),default:t(()=>[y[19]||(y[19]=v(" Redo "))]),_:1,__:[19]}),e(G,{vertical:""}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-delete",tile:""},C,{onClick:y[3]||(y[3]=be=>f.value?.show())}),null,16)]),default:t(()=>[y[20]||(y[20]=v(" Clear "))]),_:1,__:[20]}),e(G,{vertical:""}),e(M,{location:"bottom"},{activator:t(({props:C})=>[e(k,_({icon:"mdi-code-json",tile:""},C,{onClick:m}),null,16)]),default:t(()=>[y[21]||(y[21]=v(" Geojson Source "))]),_:1,__:[21]})]),_:1}),e(xo,{ref_key:"confirmModal",ref:f,danger:"",message:"Are you sure you want to remove all features?",title:"Clear",onSubmit:S},null,512),e(Ao,{ref_key:"propertiesModal",ref:w,onCancel:E(F),onDelete:E(I),onSubmit:E(V)},null,8,["onCancel","onDelete","onSubmit"]),e(Co,{ref_key:"codeModal",ref:s,onClose:E(d)},null,8,["onClose"])],64))}}),Ro=N({__name:"HomeView",setup(r){const o=W(),n=he(),l=ee(),a=h(),u=h(),s=h(),f=h(!1),w=B({get:()=>o.message,set:c=>o.setMessage(c)}),p=B({get:()=>o.loading,set:c=>o.setLoading(c)}),A=B({get:()=>n.level,set:c=>n.setLevel(c)}),g=new ge({source:new Ge({features:l.features}),style:c=>Ae(c),zIndex:10,properties:{id:"editorLayer"}});return q(()=>A.value,c=>{const x=a.value?.map;if(!x)return;const b=x.getLayers();b.forEach(i=>(i instanceof ge&&vo(i,c),i)),x.setLayers(b)}),q(()=>w.value,c=>a.value?.notification.show(c)),Ue(async()=>{const c=a.value?.map;c&&(p.value=!0,c.addLayer(g),p.value=!1)}),tt(async(c,x,b)=>{c.params.region!==x.params.region&&(f.value=!1),b(),await ve(),c.params.region!==x.params.region&&(f.value=!0)}),(c,x)=>(U(),z(Yt,{fluid:"",class:"px-0 py-0 d-flex flex-column h-100"},{default:t(()=>[a.value?(U(),z(Fo,{key:0,ref_key:"mapToolbar",ref:s,map:a.value.map,layer:E(g)},null,8,["map","layer"])):oe("",!0),e(wo,{ref_key:"mapComponent",ref:a,onContextmenu:u.value?.show},null,8,["onContextmenu"]),a.value?(U(),z(So,{key:1,ref_key:"mapContextMenu",ref:u,map:a.value.map},null,8,["map"])):oe("",!0)]),_:1}))}});export{Ro as default};
